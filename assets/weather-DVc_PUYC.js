import{p as e,a as j,w as S}from"./chunk-4WY6JWTD-CozBfH4Q.js";import{e as z,f as W,d as b}from"./weatherApi-BtUzsLrn.js";import{t as E}from"./bundle-mjs-COJ8Fh6m.js";import{c as k,X as G}from"./x-Bpw6JrRp.js";import{t as _}from"./index-D3aIsBoN.js";import"./index-DSdq1Y5I.js";const M=[["path",{d:"M8 6L12 2L16 6",key:"1yvkyx"}],["path",{d:"M12 2V22",key:"r89rzk"}]],R=k("move-up",M),N=108,A=Array.from({length:N}),T=({windspeed:t,winddirection:r,units:s})=>e.jsxs("div",{className:"relative flex h-30 w-30 items-center justify-center overflow-hidden rounded-full bg-slate-800 text-white shadow-xl",children:[A.map((x,n)=>{const a=n*(360/N),c=n%(360/40)===0;return e.jsx("div",{className:"absolute h-full w-full",style:{transform:`rotate(${a}deg)`},children:e.jsx("div",{className:E("absolute top-0 left-1/2 -translate-x-1/2 rounded-full bg-white opacity-40",c?"h-2 w-0.5":"h-1 w-px")})},n)}),e.jsx("span",{className:"absolute top-2 left-1/2 -translate-x-1/2 text-sm font-semibold text-red-500",children:"N"}),e.jsx("span",{className:"absolute top-1/2 right-2 -translate-y-1/2 text-sm font-semibold text-slate-300",children:"E"}),e.jsx("span",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 text-sm font-semibold text-slate-300",children:"S"}),e.jsx("span",{className:"absolute top-1/2 left-2 -translate-y-1/2 text-sm font-semibold text-slate-300",children:"W"}),e.jsxs("div",{className:"absolute z-10 flex flex-col items-center",children:[e.jsx("span",{className:"text-xl font-extrabold",children:t.toFixed(1)}),e.jsx("span",{className:"text-sm font-light opacity-80",children:s})]}),e.jsx("div",{className:"absolute z-20 origin-center transition-transform duration-500",style:{transform:`rotate(${r-180}deg)`},children:e.jsx(R,{size:24,className:"-mt-15 text-white drop-shadow-lg"})})]}),p=(t,r,s)=>{_[t](r,s)},u={success:(t,r)=>p("success",t,r),error:(t,r)=>p("error",t,r),info:(t,r)=>p("info",t,r),warning:(t,r)=>p("warning",t,r)};function w(t){if(t){if("status"in t){const r=t,s=r.data;return s?.errors?Object.values(s.errors).flat().join(" "):s?.message||s?.detail||JSON.stringify(r.data)}return"message"in t?t.message:"An unknown error occurred"}}const I=()=>{const[t,r]=j.useState(null),[s,x]=z(),[n,a]=W(),c=x.isLoading||a.isLoading,i=()=>r(null),m=async(l,o,g="Current location")=>{i();try{const{current_weather:{temperature:d,windspeed:f,winddirection:v,time:C},current_weather_units:L}=await s({latitude:l,longitude:o,current_weather:!0}).unwrap();r({temperature:d,windspeed:f,winddirection:v,time:C,units:L,city:g})}catch(d){console.error(d),u.error(w(d)||"Error fetching weather data")}};return{weather:t,loading:c,fetchWeatherByCoords:m,handleSearch:async l=>{if(l.trim())try{const{results:o}=await n(l).unwrap();if(!o||o.length===0){i(),u.error("City not found");return}const{latitude:g,longitude:d,name:f}=o[0];await m(g,d,f)}catch(o){console.error(o),u.error(w(o)||"Error searching city")}},handleGeoLocation:()=>{if(!navigator.geolocation){u.error("Geolocation is not supported by your browser");return}i(),navigator.geolocation.getCurrentPosition(l=>{m(l.coords.latitude,l.coords.longitude,"Current location")},()=>u.error("Geolocation access denied"),{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})},clearWeather:i}},y=Intl.DateTimeFormat().resolvedOptions().timeZone,U=()=>{const{weather:t,loading:r,handleSearch:s,handleGeoLocation:x,clearWeather:n}=I(),[a,c]=j.useState(""),i=()=>{c(""),n()},m=h=>{h.preventDefault(),a.trim()&&s(a)};return e.jsxs("div",{className:"mx-auto mt-10 max-w-lg rounded-xl bg-white p-6 shadow-lg",children:[e.jsx("h2",{className:"mb-4 text-center text-2xl font-bold",children:"Weather App"}),e.jsxs("form",{onSubmit:m,className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"text",value:a,onChange:h=>c(h.target.value),placeholder:"Enter city...",className:"w-full rounded border border-gray-300 p-2 pr-10 focus:border-blue-500 focus:outline-none"}),a.trim()&&e.jsx("button",{type:"button",onClick:i,className:"absolute top-1/2 right-2 -translate-y-1/2 p-1 text-gray-500 hover:text-gray-700","aria-label":"Clear search",children:e.jsx(G,{size:20})})]}),e.jsx("button",{type:"submit",disabled:r||!a.trim(),className:"rounded bg-blue-500 px-4 py-2 text-white hover:bg-blue-600 disabled:opacity-50",children:"Search"})]}),e.jsxs("div",{className:"flex items-center py-4",children:[e.jsx("hr",{className:"flex grow border-t border-gray-300"}),e.jsx("span",{className:"mx-4 text-sm text-gray-500",children:"or"}),e.jsx("hr",{className:"flex grow border-t border-gray-300"})]}),e.jsx("button",{onClick:()=>{i(),x()},disabled:r,className:"mb-6 w-full rounded bg-gray-200 py-2 text-gray-700 transition hover:bg-gray-300 disabled:opacity-50",children:"ðŸ“ Use my location"}),r&&e.jsx("p",{className:"py-4 text-center text-gray-500",children:"Loading..."}),!t&&!r&&e.jsx("p",{className:"py-4 text-center text-gray-400",children:"Enter a city or use your location."}),t&&!r&&e.jsxs("div",{className:"flex items-center justify-between gap-4 rounded-lg bg-blue-50 p-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-2 text-xl font-semibold",children:t.city||"Unknown city"}),e.jsxs("p",{className:"text-4xl font-bold text-blue-600",children:[t.temperature,t.units.temperature]})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("p",{className:"text-xl font-bold text-gray-800",children:b.utc(t.time).tz(y).format("LT")}),e.jsx("p",{className:"mb-2 text-sm text-gray-500",children:b.utc(t.time).tz(y).format("ll")}),e.jsxs("p",{className:"mt-2 text-center text-xs text-gray-600",children:[e.jsx("span",{className:"font-semibold",children:"Time is shown for your local timezone:"})," ",e.jsx("br",{}),e.jsx("span",{className:"font-mono text-gray-800",children:y})]})]}),e.jsx("div",{children:e.jsx(T,{windspeed:t.windspeed,winddirection:t.winddirection,units:t.units.windspeed})})]})]})},K=()=>[{title:"Weather - Sandbox"},{name:"description",content:""}],H=S(function(){return e.jsx(U,{})});export{H as default,K as meta};
